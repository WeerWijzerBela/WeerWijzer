<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weersvoorspelling</title>
    <style>
        /* Algemene stijlen */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
        }
        /* Stijlen voor de weersvoorspellingscontainer */
        #weer-container {
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 5px;
            margin: 20px auto;
            max-width: 800px;
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        /* Stijlen voor de titel */
        #stad-titel {
            margin-bottom: 10px;
            font-size: 24px;
            font-weight: bold;
            color: #333;
        }
        /* Stijlen voor de zoekbalk */
        #zoekbalk {
            margin-bottom: 10px;
            width: 100%;
            padding: 8px;
            box-sizing: border-box;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        /* Stijlen voor de knoppen */
        .knop {
            margin-top: 10px;
            margin-right: 10px;
            padding: 10px 20px;
            background-color: #007bff;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .knop:hover {
            background-color: #0056b3;
        }
        /* Stijlen voor de weersvoorspellingsitems */
        .weer-item {
            margin-bottom: 10px;
            padding: 10px;
            border-radius: 5px;
            background-color: #f9f9f9;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
        }
        .weer-item strong {
            color: #333;
        }
        .weer-item p {
            margin: 5px 0;
            color: #666;
        }
        /* Stijlen voor feedback */
        #feedback {
            margin-top: 10px;
            color: red;
        }
    </style>
</head>
<body>
    <div id="weer-container">
        <h2 id="stad-titel">Weersvoorspelling voor Apeldoorn</h2>
        <input type="text" id="zoekbalk" placeholder="Zoek een stad...">
        <div id="weer-voorspellingen">
            <!-- Hier wordt de weersvoorspellingsinformatie ingevoegd -->
        </div>
        <div id="feedback"></div>
        <button class="knop" id="terug-btn" style="display: none;">Terug</button>
        <button class="knop" id="volgende-dag-btn" style="display: none;">Volgende Dag</button>
    </div>

    <script>
        // JavaScript om de weersvoorspelling op te halen en weer te geven
        const apiUrl = 'http://127.0.0.1:8000/voorspellinguren/';
        let currentDayIndex = 0;
        let currentCity = 'Apeldoorn';

        // Functie om de weersvoorspelling voor de huidige dag op te halen en weer te geven
        async function getWeatherForecast(location, dayIndex) {
            try {
                const response = await fetch(apiUrl + location);
                const data = await response.json();
                const weatherForecastContainer = document.getElementById('weer-voorspellingen');
                const currentDate = new Date(data[0].datetime);
                currentDate.setDate(currentDate.getDate() + dayIndex); // Verplaats naar de juiste dag

                // Wis eerst de inhoud van de container
                weatherForecastContainer.innerHTML = '';
                document.getElementById('stad-titel').innerText = `Weersvoorspelling voor ${currentCity}`;
                document.getElementById('feedback').innerText = ''; // Wis eventuele feedback

                // Filter de voorspellingen voor de huidige dag
                const currentDayForecasts = data.filter(item => {
                    const itemDate = new Date(item.datetime);
                    return itemDate.getDate() === currentDate.getDate() &&
                           itemDate.getMonth() === currentDate.getMonth() &&
                           itemDate.getFullYear() === currentDate.getFullYear();
                });

                if (currentDayForecasts.length === 0) {
                    document.getElementById('feedback').innerText = 'Geen voorspellingen beschikbaar voor deze dag.';
                    return;
                }

                // Loop door de ontvangen data en voeg elk item toe aan de HTML
                currentDayForecasts.forEach(item => {
                    const weerItem = document.createElement('div');
                    weerItem.classList.add('weer-item');
                    weerItem.innerHTML = `
                        <strong>${item.datetime}</strong>
                        <p>Temperatuur: ${item.temperature}Â°C</p>
                        <p>Z-waarde: ${item.zWaarde}</p>
                    `;
                    weatherForecastContainer.appendChild(weerItem);
                });

                // Toon de knoppen als er voorspellingen zijn
                document.getElementById('terug-btn').style.display = 'inline-block';
                document.getElementById('volgende-dag-btn').style.display = 'inline-block';
            } catch (error) {
                console.error('Er is een fout opgetreden bij het ophalen van de weersvoorspelling:', error);
                document.getElementById('feedback').innerText = 'Er is een fout opgetreden bij het ophalen van de weersvoorspelling.';
            }
        }

        // Functie om naar de volgende dag te gaan en de weersvoorspellingen opnieuw te laden
        document.getElementById('volgende-dag-btn').addEventListener('click', function() {
            currentDayIndex++;
            getWeatherForecast(currentCity, currentDayIndex);
        });

        // Functie om naar de vorige dag te gaan en de weersvoorspellingen opnieuw te laden
        document.getElementById('terug-btn').addEventListener('click', function() {
            currentDayIndex--;
            getWeatherForecast(currentCity, currentDayIndex);
        });

        // Functie om de weersvoorspellingen voor de opgegeven stad te laden
        document.getElementById('zoekbalk').addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                currentCity = event.target.value;
                currentDayIndex = 0; // Reset de dad
                getWeatherForecast(currentCity, currentDayIndex);
            }
        });

        // Roep de functie op bij het laden van de pagina
        window.onload = () => getWeatherForecast(currentCity, currentDayIndex); // Standaardlocatie instellen bij het laden van de pagina
    </script>
</body>
</html>
